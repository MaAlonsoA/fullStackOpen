{"ast":null,"code":"import _defineProperty from\"D:/Dev/FullStackOpen/part3/phonedir/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/Dev/FullStackOpen/part3/phonedir/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/Dev/FullStackOpen/part3/phonedir/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{getAllPersons}from\"../services/persons/getAllPersons\";import{postNewPerson}from\"../services/persons/postNewPerson\";import{deletePersonById}from\"../services/persons/deletePersonById\";import{putPersonById}from\"../services/persons/putPersonById\";import{Persons}from\"./Persons\";import{Filter}from\"./Filter\";import{Form}from\"./Form\";import{Notification}from\"./Notification\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),newEntry=_useState4[0],setNewEntry=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),search=_useState6[0],setSearch=_useState6[1];var _useState7=useState({type:\"\",message:\"\"}),_useState8=_slicedToArray(_useState7,2),errorMessage=_useState8[0],setErrorMessage=_useState8[1];useEffect(function(){getAllPersons().then(function(persons){setPersons(persons);}).catch(function(e){messageHandler(\"error\",e.message,3000);});},[]);var messageHandler=function messageHandler(type,message){var time=arguments.length>2&&arguments[2]!==undefined?arguments[2]:3000;setErrorMessage({type:type,message:message});setTimeout(function(){setErrorMessage({type:\"\",message:\"\"});},time);};var handleChange=function handleChange(event){setNewEntry(_objectSpread(_objectSpread({},newEntry),{},_defineProperty({},event.target.name,event.target.value)));};var handleSubmit=function handleSubmit(event){event.preventDefault();if(!newEntry||!newEntry.name||!newEntry.number){return window.alert(\"Enter values\");}if(persons.some(function(elem){return elem.name===newEntry.name;})){var finded=persons.find(function(elem){return elem.name===newEntry.name;});if(window.confirm(\"\".concat(newEntry.name,\" already exist, replace the old number with a new one\"))){return putPersonById(finded.id,newEntry).then(function(){getAllPersons().then(function(response){messageHandler(\"success\",\"\".concat(finded.name,\" was successfully updated \"),5000);setPersons(response);}).catch(function(e){messageHandler(\"error\",e.message);});}).catch(function(e){messageHandler(\"error\",\"\".concat(finded.name,\" was already deleted \"));});}return;}postNewPerson(newEntry).then(function(response){setPersons(persons.concat(response));setNewEntry();});event.target.reset();setNewEntry();};var handleSearch=function handleSearch(event){setSearch(event.target.value);};var handleDelete=function handleDelete(id,name){if(window.confirm(\"Delete \".concat(name))){deletePersonById(id).then(function(){getAllPersons().then(function(persons){setPersons(persons);messageHandler(\"success\",\"\".concat(name,\" was successfully deleted \"),5000);}).catch(function(e){messageHandler(\"error\",e.message);});}).catch(function(e){messageHandler(\"error\",e.message,3000);});}};var personsToShow=search?persons.filter(function(person){return person.name.toLowerCase().includes(search.toLowerCase());}):persons;return/*#__PURE__*/_jsxs(\"div\",{children:[!errorMessage.type?null:/*#__PURE__*/_jsx(Notification,{type:errorMessage.type,message:errorMessage.message}),/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Filter,{handleSearch:handleSearch}),/*#__PURE__*/_jsx(\"h2\",{children:\"Add new \"}),/*#__PURE__*/_jsx(Form,{handleSubmit:handleSubmit,handleChange:handleChange}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{personsToShow:personsToShow,handleDelete:handleDelete})]});};","map":{"version":3,"sources":["D:/Dev/FullStackOpen/part3/phonedir/src/components/App.jsx"],"names":["React","useState","useEffect","getAllPersons","postNewPerson","deletePersonById","putPersonById","Persons","Filter","Form","Notification","App","persons","setPersons","newEntry","setNewEntry","search","setSearch","type","message","errorMessage","setErrorMessage","then","catch","e","messageHandler","time","setTimeout","handleChange","event","target","name","value","handleSubmit","preventDefault","number","window","alert","some","elem","finded","find","confirm","id","response","concat","reset","handleSearch","handleDelete","personsToShow","filter","person","toLowerCase","includes"],"mappings":"4WAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CAEA,OAASC,aAAT,KAA8B,mCAA9B,CACA,OAASC,aAAT,KAA8B,mCAA9B,CACA,OAASC,gBAAT,KAAiC,sCAAjC,CACA,OAASC,aAAT,KAA8B,mCAA9B,CAEA,OAASC,OAAT,KAAwB,WAAxB,CACA,OAASC,MAAT,KAAuB,UAAvB,CACA,OAASC,IAAT,KAAqB,QAArB,CACA,OAASC,YAAT,KAA6B,gBAA7B,C,wFAEA,MAAO,IAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,CACxB,cAA8BV,QAAQ,CAAC,EAAD,CAAtC,wCAAOW,OAAP,eAAgBC,UAAhB,eACA,eAAgCZ,QAAQ,EAAxC,yCAAOa,QAAP,eAAiBC,WAAjB,eACA,eAA4Bd,QAAQ,CAAC,EAAD,CAApC,yCAAOe,MAAP,eAAeC,SAAf,eACA,eAAwChB,QAAQ,CAAC,CAAEiB,IAAI,CAAE,EAAR,CAAYC,OAAO,CAAE,EAArB,CAAD,CAAhD,yCAAOC,YAAP,eAAqBC,eAArB,eAEAnB,SAAS,CAAC,UAAM,CACfC,aAAa,GACXmB,IADF,CACO,SAACV,OAAD,CAAa,CAClBC,UAAU,CAACD,OAAD,CAAV,CACA,CAHF,EAIEW,KAJF,CAIQ,SAACC,CAAD,CAAO,CACbC,cAAc,CAAC,OAAD,CAAUD,CAAC,CAACL,OAAZ,CAAqB,IAArB,CAAd,CACA,CANF,EAOA,CARQ,CAQN,EARM,CAAT,CAUA,GAAMM,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACP,IAAD,CAAOC,OAAP,CAAgC,IAAhBO,CAAAA,IAAgB,2DAAT,IAAS,CACtDL,eAAe,CAAC,CACfH,IAAI,CAAJA,IADe,CAEfC,OAAO,CAAPA,OAFe,CAAD,CAAf,CAIAQ,UAAU,CAAC,UAAM,CAChBN,eAAe,CAAC,CACfH,IAAI,CAAE,EADS,CAEfC,OAAO,CAAE,EAFM,CAAD,CAAf,CAIA,CALS,CAKPO,IALO,CAAV,CAMA,CAXD,CAaA,GAAME,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,KAAD,CAAW,CAC/Bd,WAAW,gCACPD,QADO,wBAETe,KAAK,CAACC,MAAN,CAAaC,IAFJ,CAEWF,KAAK,CAACC,MAAN,CAAaE,KAFxB,GAAX,CAIA,CALD,CAOA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACJ,KAAD,CAAW,CAC/BA,KAAK,CAACK,cAAN,GAEA,GAAI,CAACpB,QAAD,EAAa,CAACA,QAAQ,CAACiB,IAAvB,EAA+B,CAACjB,QAAQ,CAACqB,MAA7C,CAAqD,CACpD,MAAOC,CAAAA,MAAM,CAACC,KAAP,CAAa,cAAb,CAAP,CACA,CAED,GACCzB,OAAO,CAAC0B,IAAR,CAAa,SAACC,IAAD,CAAU,CACtB,MAAOA,CAAAA,IAAI,CAACR,IAAL,GAAcjB,QAAQ,CAACiB,IAA9B,CACA,CAFD,CADD,CAIE,CACD,GAAMS,CAAAA,MAAM,CAAG5B,OAAO,CAAC6B,IAAR,CAAa,SAACF,IAAD,CAAU,CACrC,MAAOA,CAAAA,IAAI,CAACR,IAAL,GAAcjB,QAAQ,CAACiB,IAA9B,CACA,CAFc,CAAf,CAGA,GACCK,MAAM,CAACM,OAAP,WACI5B,QAAQ,CAACiB,IADb,0DADD,CAIE,CACD,MAAOzB,CAAAA,aAAa,CAACkC,MAAM,CAACG,EAAR,CAAY7B,QAAZ,CAAb,CACLQ,IADK,CACA,UAAM,CACXnB,aAAa,GACXmB,IADF,CACO,SAACsB,QAAD,CAAc,CACnBnB,cAAc,CACb,SADa,WAEVe,MAAM,CAACT,IAFG,+BAGb,IAHa,CAAd,CAKAlB,UAAU,CAAC+B,QAAD,CAAV,CACA,CARF,EASErB,KATF,CASQ,SAACC,CAAD,CAAO,CACbC,cAAc,CAAC,OAAD,CAAUD,CAAC,CAACL,OAAZ,CAAd,CACA,CAXF,EAYA,CAdK,EAeLI,KAfK,CAeC,SAACC,CAAD,CAAO,CACbC,cAAc,CAAC,OAAD,WAAae,MAAM,CAACT,IAApB,0BAAd,CACA,CAjBK,CAAP,CAkBA,CACD,OACA,CAED3B,aAAa,CAACU,QAAD,CAAb,CAAwBQ,IAAxB,CAA6B,SAACsB,QAAD,CAAc,CAC1C/B,UAAU,CAACD,OAAO,CAACiC,MAAR,CAAeD,QAAf,CAAD,CAAV,CACA7B,WAAW,GACX,CAHD,EAIAc,KAAK,CAACC,MAAN,CAAagB,KAAb,GACA/B,WAAW,GACX,CAhDD,CAkDA,GAAMgC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAClB,KAAD,CAAW,CAC/BZ,SAAS,CAACY,KAAK,CAACC,MAAN,CAAaE,KAAd,CAAT,CACA,CAFD,CAIA,GAAMgB,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACL,EAAD,CAAKZ,IAAL,CAAc,CAClC,GAAIK,MAAM,CAACM,OAAP,kBAAyBX,IAAzB,EAAJ,CAAsC,CACrC1B,gBAAgB,CAACsC,EAAD,CAAhB,CACErB,IADF,CACO,UAAM,CACXnB,aAAa,GACXmB,IADF,CACO,SAACV,OAAD,CAAa,CAClBC,UAAU,CAACD,OAAD,CAAV,CACAa,cAAc,CACb,SADa,WAEVM,IAFU,+BAGb,IAHa,CAAd,CAKA,CARF,EASER,KATF,CASQ,SAACC,CAAD,CAAO,CACbC,cAAc,CAAC,OAAD,CAAUD,CAAC,CAACL,OAAZ,CAAd,CACA,CAXF,EAYA,CAdF,EAeEI,KAfF,CAeQ,SAACC,CAAD,CAAO,CACbC,cAAc,CAAC,OAAD,CAAUD,CAAC,CAACL,OAAZ,CAAqB,IAArB,CAAd,CACA,CAjBF,EAkBA,CACD,CArBD,CAuBA,GAAM8B,CAAAA,aAAa,CAAGjC,MAAM,CACzBJ,OAAO,CAACsC,MAAR,CAAe,SAACC,MAAD,QACfA,CAAAA,MAAM,CAACpB,IAAP,CAAYqB,WAAZ,GAA0BC,QAA1B,CAAmCrC,MAAM,CAACoC,WAAP,EAAnC,CADe,EAAf,CADyB,CAIzBxC,OAJH,CAMA,mBACC,uBACE,CAACQ,YAAY,CAACF,IAAd,CAAqB,IAArB,cACA,KAAC,YAAD,EAAc,IAAI,CAAEE,YAAY,CAACF,IAAjC,CAAuC,OAAO,CAAEE,YAAY,CAACD,OAA7D,EAFF,cAIC,iCAJD,cAKC,KAAC,MAAD,EAAQ,YAAY,CAAE4B,YAAtB,EALD,cAMC,gCAND,cAOC,KAAC,IAAD,EAAM,YAAY,CAAEd,YAApB,CAAkC,YAAY,CAAEL,YAAhD,EAPD,cAQC,+BARD,cASC,KAAC,OAAD,EAAS,aAAa,CAAEqB,aAAxB,CAAuC,YAAY,CAAED,YAArD,EATD,GADD,CAaA,CApIM","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\nimport { getAllPersons } from \"../services/persons/getAllPersons\";\r\nimport { postNewPerson } from \"../services/persons/postNewPerson\";\r\nimport { deletePersonById } from \"../services/persons/deletePersonById\";\r\nimport { putPersonById } from \"../services/persons/putPersonById\";\r\n\r\nimport { Persons } from \"./Persons\";\r\nimport { Filter } from \"./Filter\";\r\nimport { Form } from \"./Form\";\r\nimport { Notification } from \"./Notification\";\r\n\r\nexport const App = () => {\r\n\tconst [persons, setPersons] = useState([]);\r\n\tconst [newEntry, setNewEntry] = useState();\r\n\tconst [search, setSearch] = useState(\"\");\r\n\tconst [errorMessage, setErrorMessage] = useState({ type: \"\", message: \"\" });\r\n\r\n\tuseEffect(() => {\r\n\t\tgetAllPersons()\r\n\t\t\t.then((persons) => {\r\n\t\t\t\tsetPersons(persons);\r\n\t\t\t})\r\n\t\t\t.catch((e) => {\r\n\t\t\t\tmessageHandler(\"error\", e.message, 3000);\r\n\t\t\t});\r\n\t}, []);\r\n\r\n\tconst messageHandler = (type, message, time = 3000) => {\r\n\t\tsetErrorMessage({\r\n\t\t\ttype,\r\n\t\t\tmessage,\r\n\t\t});\r\n\t\tsetTimeout(() => {\r\n\t\t\tsetErrorMessage({\r\n\t\t\t\ttype: \"\",\r\n\t\t\t\tmessage: \"\",\r\n\t\t\t});\r\n\t\t}, time);\r\n\t};\r\n\r\n\tconst handleChange = (event) => {\r\n\t\tsetNewEntry({\r\n\t\t\t...newEntry,\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleSubmit = (event) => {\r\n\t\tevent.preventDefault();\r\n\r\n\t\tif (!newEntry || !newEntry.name || !newEntry.number) {\r\n\t\t\treturn window.alert(\"Enter values\");\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\tpersons.some((elem) => {\r\n\t\t\t\treturn elem.name === newEntry.name;\r\n\t\t\t})\r\n\t\t) {\r\n\t\t\tconst finded = persons.find((elem) => {\r\n\t\t\t\treturn elem.name === newEntry.name;\r\n\t\t\t});\r\n\t\t\tif (\r\n\t\t\t\twindow.confirm(\r\n\t\t\t\t\t`${newEntry.name} already exist, replace the old number with a new one`\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\treturn putPersonById(finded.id, newEntry)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tgetAllPersons()\r\n\t\t\t\t\t\t\t.then((response) => {\r\n\t\t\t\t\t\t\t\tmessageHandler(\r\n\t\t\t\t\t\t\t\t\t\"success\",\r\n\t\t\t\t\t\t\t\t\t`${finded.name} was successfully updated `,\r\n\t\t\t\t\t\t\t\t\t5000\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tsetPersons(response);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\t\t\tmessageHandler(\"error\", e.message);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\tmessageHandler(\"error\", `${finded.name} was already deleted `);\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tpostNewPerson(newEntry).then((response) => {\r\n\t\t\tsetPersons(persons.concat(response));\r\n\t\t\tsetNewEntry();\r\n\t\t});\r\n\t\tevent.target.reset();\r\n\t\tsetNewEntry();\r\n\t};\r\n\r\n\tconst handleSearch = (event) => {\r\n\t\tsetSearch(event.target.value);\r\n\t};\r\n\r\n\tconst handleDelete = (id, name) => {\r\n\t\tif (window.confirm(`Delete ${name}`)) {\r\n\t\t\tdeletePersonById(id)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tgetAllPersons()\r\n\t\t\t\t\t\t.then((persons) => {\r\n\t\t\t\t\t\t\tsetPersons(persons);\r\n\t\t\t\t\t\t\tmessageHandler(\r\n\t\t\t\t\t\t\t\t\"success\",\r\n\t\t\t\t\t\t\t\t`${name} was successfully deleted `,\r\n\t\t\t\t\t\t\t\t5000\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((e) => {\r\n\t\t\t\t\t\t\tmessageHandler(\"error\", e.message);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.catch((e) => {\r\n\t\t\t\t\tmessageHandler(\"error\", e.message, 3000);\r\n\t\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst personsToShow = search\r\n\t\t? persons.filter((person) =>\r\n\t\t\t\tperson.name.toLowerCase().includes(search.toLowerCase())\r\n\t\t  )\r\n\t\t: persons;\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t{!errorMessage.type ? null : (\r\n\t\t\t\t<Notification type={errorMessage.type} message={errorMessage.message} />\r\n\t\t\t)}\r\n\t\t\t<h2>Phonebook</h2>\r\n\t\t\t<Filter handleSearch={handleSearch} />\r\n\t\t\t<h2>Add new </h2>\r\n\t\t\t<Form handleSubmit={handleSubmit} handleChange={handleChange} />\r\n\t\t\t<h2>Numbers</h2>\r\n\t\t\t<Persons personsToShow={personsToShow} handleDelete={handleDelete} />\r\n\t\t</div>\r\n\t);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}